<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 

<c:set var="head" value="How to use the Virtual Fly Brain Stack Page" />

<c:set var="content">
  <p>This tool allows you to browse the brain, accessing information for neuropil domains, and to search for neurons and expression data associated to a neuropil domain. <br />
This page is divided into 3 areas: the Stack Viewer and its navigation tools are on the upper left and central windows; on the right hand side is an interactive anatomy tree; the lower panel corresponds to the term info window. </p>

  <h2>General usage of the Stack Viewer and Anatomy Tree </h2>

  	<ul>
	  <li>Mouse-over a region in the central-window, which shows the stack, to show the name of that region.
	  </li>
	  <li>
	  Double-click on a region of the stack to select it. Selected regions are colour-highlighted. Any associated information with that region is displayed in the lower window, the term info window. You can select as many regions as you like. The term info window displays information for the last selected region.
	  </li>
	  <li>
	  Select a term in the anatomy tree window on the right by clicking once. You can select as many regions as you like. To see the corresponding region colour-highlighted in the stack, click on the square to the left or on 'centre' to the right of the term in the tree. 
	  </li>
	  <li>
	  Clicking 'centre' next to a term in the anatomy tree changes the view of the stack, centering it on that region. This centered view will be maintained if the plane of view (frontal, horizontal, sagittal or others) is subsequently changed.       
	  </li>	  
	  <li>
	  Using the controls found to the left of the stack, the image can be arbitrarily rotated, zoomed, or observed in the X-, Y- and Z-axes. Pre-selected planes of view for frontal, horizontal and sagittal orientations are also provided as options.
	  </li>	  
	  <li>
	  Use the search box at the top of the anatomy tree to quickly locate structures of interest. The box provides auto-complete functionality. When the region of interest is found, hit "Enter" - the tree will expand to show the searched term, and the information for this term will be displayed in the lower window-the term info window.       
	  </li>
	  <li>
	  Use the "Show all Domains/Clear all Selections" option, found below the search box, to quickly view/clear all selected regions in the stack. Clicking "Clear all Selections" also collapses the tree to the default initial state.           
	  </li>
	  <li> 
	  You can modify the colour with which neuropils are painted. Click, before or after selecting a term in the tree, on the grey square to the left of the term name. Select a new colour by clicking with the mouse on the colour picker. Close the window by pressing 'X'. Un-tick and re-tick the anatomy term to activate the new colour.
	  </li>
	  </ul>
	  
	  <h2>Generating a composite view</h2>
	  <ul>
	  <li> You can build a composite view from different images stacks which have been integrated on the site. Clicking on "See in viewer" from any image stack to see that image in the Viewer.
	  </li>
	  <li> Together with the image stack, any neuropil domain can be highlighted on the brain stack.
	  </li>
	  <li>
	  To see the metadata associated with the image stack click in "About ...". the information will be shown below, in the term info window.
	  </li>
	  <li>To add an image to the composite, click "Add to composite view" on the left of the Viewer, under Stack actions'. A composite view holds up to three stacks at any one time. You can use the 'Back' button in your browser, or run a new query to find other images to add to the composite.
	  </li>
	  <li>To check or delete stacks from your current, click "Edit current composite view" on the right hand side of the top grey bar.
	  </li>
	  <li>Each composite view is associated to a permanent URL, permalink, which you can share with others. Once you obtain a permalink for the composite, it will no longer be editable.
	  </li>
	  

	<h2>Term info window</h2>

	<ul>
	  <li>This window lists the information associated to a term. The same information would be displayed when searching for that term in the Anatomy/Neuron Finder. To preserve your selection of terms in the stack, open the links of the term info window in a new tab, using the right/control click and choosing 'Open link in new tab'. </li>
	  <li> Sections on this window include: Definition, Synonyms, References (when applicable), Parent classes and Relationship. There might also be a Comment section, below the definition.</li>
		  <li>The References section lists the relevant papers used to define that term. Links to the FlyBase Reference Report pages are provided.</li>
		  <li>The Parent classes list the parent classes of that term in the anatomy ontology with links. Clicking on a term displays an information page for that term.</li>
		  <li>The Relationships section lists all other relationships of that term in the ontology with links. These might include part_of, connected_to, has_synaptic_terminals_in (pre- or postsynaptic), develops_from, etc. Clicking on a term displays an information page for that term.</li>
	  	  <li>Below the Relationships section, or when applicable in other sections, links to display a neuropil domain in the Stack Viewer are provided ('See in Viewer'). Links to the FlyBase page for that anatomy term (CV Term Report) and the NeuroLex Wiki are also available.</li>
	</li>
		  </ul>

<h2>How to run a query</h2> 

       <ul>
	  <li>
	  The query menu is on the top of the term info window ('Query for'). Hovering on the query options available to the right of 'Query for'  will display all available query sub-options. Click on the desired query sub-option to run the query.</li>
	  <li>Using this query menu, the user can choose to search for: neuron classes by location and innervation (with the option of specifying pre- or postsynaptic terminals), single neurons by location, tracts, gene/transgene expression and phenotype associated with a neuropil domain.</li>
	  </li>
	  <li>The results are listed on the same window. To preserve your selection of terms in the stack, open the links of the term info window in a new tab, using the right/control click and choosing 'Open link in new tab'. The format will be different depending on the type of query.</li>
		  <li>For neuron classes, tract queries and lineage clones, clicking on 'More info' for a term displays the information for that term. The same information would be displayed in the Anatomy/Neuron Finder page or on the Term info window (if it is a neuropil domain). If images are available, they will be shown as well. To display these on the Viewer, click "See in viewer".</li>
		  <li>For queries for individual neurons by location, the result list shows groups of morphologically similar neurons (clusters), the average neuron of that cluster (exemplar), and the link to members of that cluster (Show individual neurons).</li>
		  <li>Interactive 3D representations (WebGL) of each cluster, together with some more cluster information is available by clicking on the cluster image. </li>
		  <li>The window 'Show individual neurons' displays the neuron name, a thumbnail of the neuron ('Neuron preview'), annotations ('Type') and the driver used to label that neuron ('Driver'). To display the neuron in the Viewer, click "See in viewer".
		  </li>
		  <li>For expression queries, the result lists have three columns. The first shows the driver/reporter, gene or alelle, the second displays the relevant anatomy term ('expressed in' or 'phenotype in'), and the third lists the references. The first and third columns link to the appropriate pages on FlyBase. Clicking on a term in the second column displays the information that term in the same window. It is the same information as in the Anatomy/Neuron Finder Pages or on the Term info window (if it is a neuropil domain).</li>
	 
	</ul>
</c:set>	
 <jsp:include page="/jsp/includes/help.jsp">
 	<jsp:param name="head" value="${head}" />
 	<jsp:param name="content" value="${content}" />
 </jsp:include> 
